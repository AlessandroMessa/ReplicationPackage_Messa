Contesto e problema
Nella classe MessageService erano definite localmente due stringhe “magic” per i nomi dei canali Redis:

java
Copia
Modifica
public static String MESSAGE_CHANNEL = "message";
public static String CLOSE_CHANNEL   = "close";
Questa collocazione porta a:

Duplicazione di literal in più punti (anche in WebSocketService).

Rischio di typo o incoerenza quando il nome di un canale cambia.

Dipendenze incrociate: le due service si importavano reciprocamente le costanti, generando un ciclo.

Obiettivo
Spezzare la dipendenza circolare e centralizzare i nomi dei canali in un unico luogo, riducendo il coupling e migliorando manutenibilità e chiarezza.

Soluzione adottata
Estrazione in package push.common

Creato un package com.stalary.pf.push.common dedicato ai tipi e alle costanti del dominio push.

Spostata qui la definizione dei canali, rimuovendoli da MessageService (e da WebSocketService).

Implementazione con enum (opzionale)

Utilizzo di un enum invece di una semplice classe di costanti, per avere:

Un tipo chiuso che elenca esplicitamente i canali validi.

Una proprietà interna channel per conservarne il valore stringa.

Un getter (getChannel()) o un metodo matches(...) per il confronto.

Aggiornamento di MessageService

Rimosse le variabili statiche locali.

Sostituiti i controlli su "message" e "close" con:

java
Copia
Modifica
if (PushConstants.MESSAGE_CHANNEL.getChannel().equals(channel)) { … }
else if (PushConstants.CLOSE_CHANNEL.getChannel().equals(channel)) { … }
Import diretto da com.stalary.pf.push.common.PushConstants, senza riferimenti reciproci a WebSocketService.

Vantaggi ottenuti
Unico punto di verità: il nome dei canali è definito in un solo file, semplificando eventuali modifiche.

Eliminazione del ciclo: nessun import bidirezionale fra MessageService e WebSocketService.

Tipizzazione forte (se si usa l’enum): riduce gli errori di string literal e documenta esplicitamente i canali consentiti.

Coesione: il modulo push resta autosufficiente, con un package common di piccole dimensioni dedicato alle costanti di dominio.