Refactoring per l'eliminazione dello Smell "Unstable Dependency"
Durante l’attività di analisi architetturale del modulo order-server, è stato rilevato uno Architectural Smell di tipo Unstable Dependency, causato dalla dipendenza diretta del modulo order-server verso un modulo meno stabile, in violazione del principio di Stable Dependencies. In particolare, il modulo dipendeva da un package provider, responsabile della logica di accesso a servizi esterni e interni (es. gestione coupon, stock, integrazioni).

Obiettivo del refactoring
L'obiettivo del refactoring è stato:

Eliminare lo smell "Unstable Dependency" tra order-server e il package provider

Preservare l’indipendenza e la stabilità del modulo order-server

Evitare la creazione di cicli di dipendenza tra i moduli

Strategia adottata
Per raggiungere l’obiettivo, è stato applicato un refactoring architetturale strutturato nei seguenti passaggi:

Spostamento del package provider
Il package provider, inizialmente incluso all’interno del modulo order-server, è stato estratto e trasferito nel modulo mall-support, modulo a supporto trasversale che già conteneva logiche condivise.

Creazione del modulo order-common
Al fine di evitare dipendenze cicliche tra mall-support e order-server, le classi condivise tra i provider e order-server (es. DTO, enum, costanti, modelli) sono state estratte in un nuovo modulo condiviso denominato order-common. Questo modulo ha il solo scopo di contenere definizioni stateless e riutilizzabili, senza dipendenze logiche verso i moduli principali.

Aggiornamento delle dipendenze Maven
Il modulo order-server è stato modificato per dipendere esclusivamente da order-common e da mall-support. È stata inoltre rimossa ogni dipendenza inversa da mall-support verso order-server, al fine di evitare dipendenze instabili o cicliche.

Correzione della configurazione del compilatore
In seguito alla creazione del nuovo modulo mall-support, è stato riscontrato un errore di compilazione legato all'impostazione della versione target Java (21) non compatibile con il JDK installato. È stata quindi corretta la configurazione del plugin maven-compiler-plugin, impostando 1.8 come valore per maven.compiler.source e maven.compiler.target, in linea con il resto del progetto.

Verifica del refactoring con Arcan
Al termine delle modifiche, è stato rieseguito lo strumento Arcan per valutare lo stato architetturale aggiornato. Lo smell "Unstable Dependency" è stato completamente rimosso, confermando il successo del refactoring. Tuttavia, come effetto collaterale, è stato rilevato un nuovo smell di tipo Hub-Like Dependency, localizzato nel modulo mall-support.

Considerazioni sullo smell "Hub-Like Dependency"
L’introduzione dello smell "Hub-Like Dependency" nel modulo mall-support è considerata un compromesso accettabile, in quanto:

Il modulo mall-support è progettato per contenere logiche trasversali e condivise;

Il codice contenuto è stato organizzato in sottopacchetti tematici (es. coupon, stock, integration) per facilitare una futura modularizzazione;

Lo smell è localizzato e facilmente gestibile, rispetto alla criticità architetturale dell’Unstable Dependency originaria.

Risultato finale
Smell	Stato
Unstable Dependency	✅ Rimosso
Hub-Like Dependency	⚠️ Introdotto ma controllato

Il refactoring ha migliorato l’architettura complessiva del sistema, rendendola più stabile e mantenibile, e preparando il progetto a una futura evoluzione modulare ancora più granulare.